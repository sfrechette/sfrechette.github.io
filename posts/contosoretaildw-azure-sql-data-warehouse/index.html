<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="StÃ©phane FrÃ©chette">
    <meta name="description" content="StÃ©phane FrÃ©chette&#39;s personal website">
    <meta name="keywords" content="stephane frechette,blog,data engineer,cloud solution architect,google cloud">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ContosoRetailDW on Azure SQL Data Warehouse"/>
<meta name="twitter:description" content="Happy New Year! It as been a while my friendsâ€¦ here goes ðŸ˜‰
ContosoRetailDW on Azure SQL Data Warehouse This post assumes you are familiar or have already been introduced to Azure SQL Data Warehouse. If not I strongly encourage to read and follow-up on the SQL Data Warehouse Documentationto get you going.
Optionally if you would like to have a local on premise copy of the ContosoRetailDW database â€“ A fictitious retail demo dataset used for presenting Microsoft Business Intelligence products."/>

    <meta property="og:title" content="ContosoRetailDW on Azure SQL Data Warehouse" />
<meta property="og:description" content="Happy New Year! It as been a while my friendsâ€¦ here goes ðŸ˜‰
ContosoRetailDW on Azure SQL Data Warehouse This post assumes you are familiar or have already been introduced to Azure SQL Data Warehouse. If not I strongly encourage to read and follow-up on the SQL Data Warehouse Documentationto get you going.
Optionally if you would like to have a local on premise copy of the ContosoRetailDW database â€“ A fictitious retail demo dataset used for presenting Microsoft Business Intelligence products." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stephanefrechette.dev/posts/contosoretaildw-azure-sql-data-warehouse/" />
<meta property="article:published_time" content="2016-01-03T14:58:27-04:00" />
<meta property="article:modified_time" content="2016-01-03T14:58:27-04:00" />


    
      <base href="https://stephanefrechette.dev/posts/contosoretaildw-azure-sql-data-warehouse/">
    
    <title>
  ContosoRetailDW on Azure SQL Data Warehouse Â· StÃ©phane FrÃ©chette
</title>

    
      <link rel="canonical" href="https://stephanefrechette.dev/posts/contosoretaildw-azure-sql-data-warehouse/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://stephanefrechette.dev/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://stephanefrechette.dev/css/custom.css">
    

    <link rel="icon" type="image/png" href="https://stephanefrechette.dev/images/me-cartoon-32x32.jpg" sizes="32x32">
    <link rel="icon" type="image/png" href="https://stephanefrechette.dev/images/me-cartoon-16x16.jpg" sizes="16x16">

    <meta name="generator" content="Hugo 0.61.0" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://stephanefrechette.dev">
      StÃ©phane FrÃ©chette
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://stephanefrechette.dev/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://stephanefrechette.dev/talks/">Talks</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://stephanefrechette.dev/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">ContosoRetailDW on Azure SQL Data Warehouse</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2016-01-03T14:58:27-04:00'>
                January 3, 2016
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              19 minutes read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="https://stephanefrechette.dev/categories/databases/">Databases</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/categories/cloud-computing/">Cloud Computing</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/categories/azure/">Azure</a></div>

          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://stephanefrechette.dev/tags/azure/">azure</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/azure-sql-data-warehouse/">azure sql data warehouse</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/cloud/">cloud</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/contosoretaildw/">contosoretaildw</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/data-warehouse/">data warehouse</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/microsoft-azure/">microsoft azure</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/polybase/">polybase</a>
      <span class="separator">â€¢</span>
    <a href="https://stephanefrechette.dev/tags/sql-data-warehouse/">sql data warehouse</a></div>

        </div>
      </header>
      
      <div>
        <p>Happy New Year! It as been a while my friendsâ€¦ here goes ðŸ˜‰</p>
<h4 id="contosoretaildw-on-azure-sql-data-warehouse">ContosoRetailDW on Azure SQL Data Warehouse</h4>
<p>This post assumes you are familiar or have already been introduced to Azure SQL Data Warehouse. If not I strongly encourage to read and follow-up on the <!-- raw HTML omitted -->SQL Data Warehouse Documentation<!-- raw HTML omitted --> to get you going.</p>
<p>Optionally if you would like to have a local on premise copy of the ContosoRetailDW database â€“ A fictitious retail demo dataset used for presenting Microsoft Business Intelligence products. You can download here  <!-- raw HTML omitted -->-&gt; <a href="https://www.microsoft.com/en-ca/download/details.aspx?id=18279">https://www.microsoft.com/en-ca/download/details.aspx?id=18279</a><!-- raw HTML omitted --></p>
<p>As much as we love AdventureWorks, it is also worthwhile to explore and work with bigger data volumes, to develop and test new concepts! Hence the entire ContosoRetailDW database contains more than 34M rows of records. So I decided to make it happenâ€¦ContosoRetailDW on Azure SQL Data Warehouse.</p>
<p>Before we start the scripts (code) for this post are available here on GitHub -&gt; <!-- raw HTML omitted --><a href="https://github.com/sfrechette/contosoretaildw-azuresqldw">https://github.com/sfrechette/contosoretaildw-azuresqldw</a><!-- raw HTML omitted --></p>
<p>First thing letâ€™s start by creating a blank SQL Data Warehouse database named ContosoRetailDW (<!-- raw HTML omitted -->Create a SQL Data Warehouse<!-- raw HTML omitted -->)</p>
<figure>
    <img src="https://stephanefrechette.dev/images/legacy-post/azure_sqldw.png"
         alt="azure_sqldw" width="1052" height="700"/> 
</figure>

<p>Next we need to create a slightly redesigned and modified ContosoRetailDW schema for the data to be imported and used in Azure SQL Data Warehouse. I have removed the following 3 columns from each tables; <strong>ETLLoadID</strong>, <strong>LoadDate</strong> and <strong>UpdateDate</strong> and in addition columns of data type <strong>geography</strong> and <strong>geometry</strong> which are not supported in SQL Data Warehouse.</p>
<p>After successfully creating the SQL Data Warehouse database connect with Visual Studio (<!-- raw HTML omitted -->Connect to SQL Data Warehouse with Visual Studio<!-- raw HTML omitted -->) to your newly created blank database and run the following dsql script to create the schema for the ContosoRetailDW database.</p>
<p>For detailed information on table design -&gt; <!-- raw HTML omitted -->Table design in SQL Data Warehouse<!-- raw HTML omitted --></p>
<p><strong>ContosoRetailDW DDL schema script â€“ ContosoRetailDW_ddl.dsql</strong></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">USE ContosoRetailDW;

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimAccount](
	[AccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentAccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[<span style="color:#007020;font-weight:bold">Operator</span>] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomMembers] [nvarchar](<span style="color:#40a070">300</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ValueType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomMemberOptions] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimChannel](
	[ChannelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimCurrency](
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyLabel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimCustomer](
	[CustomerKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Title] [nvarchar](<span style="color:#40a070">8</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[FirstName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MiddleName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NameStyle] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BirthDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaritalStatus] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Suffix] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Gender] [nvarchar](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmailAddress] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[YearlyIncome] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalChildren] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[NumberChildrenAtHome] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Education] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Occupation] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[HouseOwnerFlag] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NumberCarsOwned] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine1] [nvarchar](<span style="color:#40a070">120</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine2] [nvarchar](<span style="color:#40a070">120</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Phone] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateFirstPurchase] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerType] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CompanyName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(CustomerKey)); 

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimDate](
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FullDateLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateDescription] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarHalfYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarHalfYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarQuarter] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarQuarterLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarMonth] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarMonthLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarWeek] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarWeekLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarDayOfWeek] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarDayOfWeekLabel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalHalfYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalHalfYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalQuarter] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalQuarterLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalMonth] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalMonthLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[IsWorkDay] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[IsHoliday] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[HolidayName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EuropeSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NorthAmericaSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AsiaSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimEmployee](
	[EmployeeKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEmployeeKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[FirstName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MiddleName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Title] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[HireDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BirthDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmailAddress] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Phone] [nvarchar](<span style="color:#40a070">25</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaritalStatus] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmergencyContactName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmergencyContactPhone] [nvarchar](<span style="color:#40a070">25</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalariedFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Gender] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PayFrequency] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BaseRate] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[VacationHours] [<span style="color:#007020">smallint</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrentFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesPersonFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DepartmentName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimEntity](
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEntityLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityDescription] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityType] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimGeography](
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ContinentName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CityName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StateProvinceName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[RegionCountryName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimMachine](
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[VendorName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineOS] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineSource] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineHardware] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineSoftware] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ServiceStartDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DecommissionDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastModifiedDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimOutage](
	[OutageKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageTypeDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageSubType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageSubTypeDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimProduct](
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductLabel] [nvarchar](<span style="color:#40a070">255</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductName] [nvarchar](<span style="color:#40a070">500</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductDescription] [nvarchar](<span style="color:#40a070">400</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Manufacturer] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[BrandName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ClassID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ClassName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StyleID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StyleName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ColorID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ColorName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[<span style="color:#007020;font-weight:bold">Size</span>] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SizeRange] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SizeUnitMeasureID] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Weight] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[WeightUnitMeasureID] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitOfMeasureID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitOfMeasureName] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StockTypeID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StockTypeName] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AvailableForSaleDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StopSaleDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">7</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ImageURL] [nvarchar](<span style="color:#40a070">150</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductURL] [nvarchar](<span style="color:#40a070">150</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(ProductKey));

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimProductCategory](
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryName] [nvarchar](<span style="color:#40a070">30</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimProductSubcategory](
	[ProductSubcategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryDescription] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
) <span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimPromotion](
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionDescription] [nvarchar](<span style="color:#40a070">255</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountPercent] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionCategory] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MinQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaxQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimSalesTerritory](
	[SalesTerritoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryRegion] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryCountry] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryGroup] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryLevel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryManager] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimScenario](
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[DimStore](
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreManager] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreType] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreDescription] [nvarchar](<span style="color:#40a070">300</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OpenDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CloseDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[ZipCode] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ZipCodeExtension] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StorePhone] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreFax] [nvarchar](<span style="color:#40a070">14</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine1] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine2] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CloseReason] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmployeeCount] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[SellingAreaSize] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastRemodelDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactExchangeRate](
	[ExchangeRateKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[AverageRate] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndOfDayRate] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactInventory](
	[InventoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OnHandQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OnOrderQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SafetyStockQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DaysInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MinDayInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaxDayInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Aging] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(InventoryKey));

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactITMachine](
	[ITMachinekey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CostAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CostType] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
) 
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactITSLA](
	[ITSLAkey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageStartTime] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageEndTime] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DownTime] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>);

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactOnlineSales](
	[OnlineSalesKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesOrderNumber] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesOrderLineNumber] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(OnlineSalesKey),
PARTITION(DateKey RANGE <span style="color:#007020;font-weight:bold">RIGHT</span> <span style="color:#007020;font-weight:bold">FOR</span> <span style="color:#007020;font-weight:bold">VALUES</span> (	<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2005-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2006-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2007-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2008-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2009-01-01</span><span style="color:#4070a0">&#39;</span>,
											<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2010-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2011-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2012-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2013-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2014-01-01</span><span style="color:#4070a0">&#39;</span>,
											<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2015-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2016-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2017-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2018-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2019-01-01</span><span style="color:#4070a0">&#39;</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">2020-01-01</span><span style="color:#4070a0">&#39;</span>)));

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactSales](
	[SalesKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[channelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(SalesKey));

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactSalesQuota](
	[SalesQuotaKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantityQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmountQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GrossMarginQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(SalesQuotaKey));

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> [dbo].[FactStrategyPlan](
	[StrategyPlanKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Amount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (CLUSTERED COLUMNSTORE <span style="color:#007020;font-weight:bold">INDEX</span>, DISTRIBUTION <span style="color:#666">=</span> HASH(StrategyPlanKey));
</code></pre></div><p><strong>Got Data!</strong><br>
We need to load some data! The GZip data files, 25 of them totalling approx. 413MB are located here on OneDrive -&gt; <!-- raw HTML omitted --><a href="https://1drv.ms/f/s">https://1drv.ms/f/s</a>!Al_yetnJltJSmUP0M0MBPTUSNOqa<!-- raw HTML omitted -->. You will need to load these files to an Azure blob storage. James Serra has a great post to help you get started: <!-- raw HTML omitted -->Getting data into Azure Blob Storage<!-- raw HTML omitted -->. For the purpose of this exercise I created a blob storage container name â€˜contosoretaildwâ€™ with a â€˜dataâ€™ folder and imported the GZip files using the AzCopy Command-Line Utility (<!-- raw HTML omitted -->Transfer data with the AzCopy Command-Line Utility<!-- raw HTML omitted -->)</p>
<figure>
    <img src="https://stephanefrechette.dev/images/legacy-post/blob_contoso-1024x941.png"
         alt="blob_contoso" width="1024" height="750"/> 
</figure>

<p>Will be loading data from blob storage to SQL Data Warehouse using Polybase (<!-- raw HTML omitted -->Load data with PolyBase in SQL Data Warehouse<!-- raw HTML omitted -->) The following script assumes we already have defined and created a schema for the ContosoRetailDW database. You could also load data using the CTAS (Create Table As Select) feature only if you have not yet defined and created the ContosoRetailDW schema. The script for this scenario PolybaseLoadCTAS.dsql is available on <!-- raw HTML omitted -->GitHub<!-- raw HTML omitted -->.</p>
<p><strong>Loading data from Azure Blog Storage â€“ PolybaseLoadInsert.dsql</strong></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#60a0b0;font-style:italic">--Create Schema for External Tables 
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">SCHEMA</span> ext;

<span style="color:#60a0b0;font-style:italic">--Create Master Key. Required to encrypt the credential secret in the next step.
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> MASTER <span style="color:#007020;font-weight:bold">KEY</span>;

<span style="color:#60a0b0;font-style:italic">--Create Database Scoped Credential. Provide the Azure storage account key. 
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#60a0b0;font-style:italic">--The identity name does not affect authentication to Azure storage.
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">DATABASE</span> SCOPED CREDENTIAL AzureStorageCredential 
<span style="color:#007020;font-weight:bold">WITH</span> <span style="color:#007020;font-weight:bold">IDENTITY</span> <span style="color:#666">=</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">user</span><span style="color:#4070a0">&#39;</span>, 
SECRET <span style="color:#666">=</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">azure_storage_account_key_goes_here</span><span style="color:#4070a0">&#39;</span>;

<span style="color:#60a0b0;font-style:italic">--Create External Data Source. Specify location and credential to access your Azure blob storage.
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">DATA</span> <span style="color:#007020;font-weight:bold">SOURCE</span> AzureStorage 
<span style="color:#007020;font-weight:bold">WITH</span> (  
        <span style="color:#007020;font-weight:bold">TYPE</span> <span style="color:#666">=</span> Hadoop, 
        <span style="color:#007020;font-weight:bold">LOCATION</span> <span style="color:#666">=</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">wasbs://contosoretaildw@stephdefaultstorage.blob.core.windows.net/</span><span style="color:#4070a0">&#39;</span>,
        CREDENTIAL <span style="color:#666">=</span> AzureStorageCredential
); 

<span style="color:#60a0b0;font-style:italic">--Create External File format. Specify the layout of data stored in Azure storage blobs. 
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> FILE FORMAT TextFileFormat 
<span style="color:#007020;font-weight:bold">WITH</span> 
(   
    FORMAT_TYPE <span style="color:#666">=</span> DELIMITEDTEXT, 
    FORMAT_OPTIONS  
    (
        FIELD_TERMINATOR <span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">|</span><span style="color:#4070a0">&#39;</span>,
        USE_TYPE_DEFAULT <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">FALSE</span>
    ),
	DATA_COMPRESSION <span style="color:#666">=</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">org.apache.hadoop.io.compress.GzipCodec</span><span style="color:#4070a0">&#39;</span>
);

<span style="color:#60a0b0;font-style:italic">--DimAccount
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimAccount (
	[AccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentAccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[<span style="color:#007020;font-weight:bold">Operator</span>] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomMembers] [nvarchar](<span style="color:#40a070">300</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ValueType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomMemberOptions] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimAccount.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimAccount
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimAccount;

<span style="color:#60a0b0;font-style:italic">--DimChannel
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimChannel (
	[ChannelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimChannel.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimChannel
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimChannel;

<span style="color:#60a0b0;font-style:italic">--DimCurrency
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimCurrency (
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyLabel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimCurrency.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimCurrency
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimCurrency;

<span style="color:#60a0b0;font-style:italic">--DimCustomer
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimCustomer (
	[CustomerKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Title] [nvarchar](<span style="color:#40a070">8</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[FirstName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MiddleName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NameStyle] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BirthDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaritalStatus] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Suffix] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Gender] [nvarchar](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmailAddress] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[YearlyIncome] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalChildren] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[NumberChildrenAtHome] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Education] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Occupation] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[HouseOwnerFlag] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NumberCarsOwned] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine1] [nvarchar](<span style="color:#40a070">120</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine2] [nvarchar](<span style="color:#40a070">120</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Phone] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateFirstPurchase] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerType] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CompanyName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimCustomer.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimCustomer
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimCustomer;

<span style="color:#60a0b0;font-style:italic">--DimDate
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimDate (
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FullDateLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateDescription] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarHalfYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarHalfYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarQuarter] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarQuarterLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarMonth] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarMonthLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarWeek] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarWeekLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarDayOfWeek] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CalendarDayOfWeekLabel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalHalfYear] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalHalfYearLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalQuarter] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalQuarterLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalMonth] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[FiscalMonthLabel] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[IsWorkDay] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[IsHoliday] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[HolidayName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EuropeSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[NorthAmericaSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AsiaSeason] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimDate.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimDate
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimDate;

<span style="color:#60a0b0;font-style:italic">--DimEmployee
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimEmployee (
	[EmployeeKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEmployeeKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[FirstName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MiddleName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Title] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[HireDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BirthDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmailAddress] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Phone] [nvarchar](<span style="color:#40a070">25</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaritalStatus] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmergencyContactName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmergencyContactPhone] [nvarchar](<span style="color:#40a070">25</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalariedFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Gender] [<span style="color:#007020;font-weight:bold">nchar</span>](<span style="color:#40a070">1</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PayFrequency] [tinyint] <span style="color:#007020;font-weight:bold">NULL</span>,
	[BaseRate] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[VacationHours] [<span style="color:#007020">smallint</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrentFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesPersonFlag] [<span style="color:#007020">bit</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DepartmentName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [<span style="color:#007020">date</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimEmployee.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimEmployee
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimEmployee;

<span style="color:#60a0b0;font-style:italic">--DimEntity
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimEntity (
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[ParentEntityLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityDescription] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityType] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimEntity.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimEntity
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimEntity;

<span style="color:#60a0b0;font-style:italic">--DimGeography
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimGeography (
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ContinentName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CityName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StateProvinceName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[RegionCountryName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimGeography.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimGeography
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimGeography;

<span style="color:#60a0b0;font-style:italic">--DimMachine
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimMachine (
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[VendorName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineOS] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineSource] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineHardware] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineSoftware] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ServiceStartDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DecommissionDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastModifiedDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimMachine.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimMachine
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimMachine;

<span style="color:#60a0b0;font-style:italic">--DimOutage
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimOutage (
	[OutageKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageTypeDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageSubType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageSubTypeDescription] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimOutage.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimOutage
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimOutage;

<span style="color:#60a0b0;font-style:italic">--DimProduct
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimProduct (
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductLabel] [nvarchar](<span style="color:#40a070">255</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductName] [nvarchar](<span style="color:#40a070">500</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductDescription] [nvarchar](<span style="color:#40a070">400</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Manufacturer] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[BrandName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ClassID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ClassName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StyleID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StyleName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ColorID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ColorName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[<span style="color:#007020;font-weight:bold">Size</span>] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SizeRange] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SizeUnitMeasureID] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[Weight] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[WeightUnitMeasureID] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitOfMeasureID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitOfMeasureName] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StockTypeID] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StockTypeName] [nvarchar](<span style="color:#40a070">40</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[AvailableForSaleDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StopSaleDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">7</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ImageURL] [nvarchar](<span style="color:#40a070">150</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductURL] [nvarchar](<span style="color:#40a070">150</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimProduct.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimProduct
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimProduct;

<span style="color:#60a0b0;font-style:italic">--DimProductCategory
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimProductCategory (
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryName] [nvarchar](<span style="color:#40a070">30</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimProductCategory.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimProductCategory
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimProductCategory;

<span style="color:#60a0b0;font-style:italic">--DimProductSubcategory
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimProductSubcategory (
	[ProductSubcategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductSubcategoryDescription] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimProductSubcategory.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimProductSubcategory
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimProductSubcategory;

<span style="color:#60a0b0;font-style:italic">--DimPromotion
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimPromotion (
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionDescription] [nvarchar](<span style="color:#40a070">255</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountPercent] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionType] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionCategory] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MinQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaxQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimPromotion.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimPromotion
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimPromotion;

<span style="color:#60a0b0;font-style:italic">--DimSalesTerritory
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimSalesTerritory (
	[SalesTerritoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryName] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryRegion] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryCountry] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryGroup] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryLevel] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesTerritoryManager] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StartDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimSalesTerritory.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimSalesTerritory
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimSalesTerritory;

<span style="color:#60a0b0;font-style:italic">--DimScenario
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimScenario (
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioLabel] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioName] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioDescription] [nvarchar](<span style="color:#40a070">50</span>) <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimScenario.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimScenario
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimScenario;

<span style="color:#60a0b0;font-style:italic">--DimStore
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.DimStore (
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GeographyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreManager] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreType] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreName] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreDescription] [nvarchar](<span style="color:#40a070">300</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Status] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OpenDate] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CloseDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[ZipCode] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[ZipCodeExtension] [nvarchar](<span style="color:#40a070">10</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StorePhone] [nvarchar](<span style="color:#40a070">15</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreFax] [nvarchar](<span style="color:#40a070">14</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine1] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[AddressLine2] [nvarchar](<span style="color:#40a070">100</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[CloseReason] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NULL</span>,
	[EmployeeCount] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[SellingAreaSize] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[LastRemodelDate] [datetime] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/DimStore.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.DimStore
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.DimStore;

<span style="color:#60a0b0;font-style:italic">--FactExchangeRate
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactExchangeRate (
	[ExchangeRateKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[AverageRate] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EndOfDayRate] [<span style="color:#007020">float</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactExchangeRate.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactExchangeRate
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactExchangeRate;

<span style="color:#60a0b0;font-style:italic">--FactInventory
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactInventory (
	[InventoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OnHandQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OnOrderQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SafetyStockQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DaysInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MinDayInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[MaxDayInStock] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Aging] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactInventory.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactInventory
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactInventory;

<span style="color:#60a0b0;font-style:italic">--FactITMachine
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactITMachine (
	[ITMachinekey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CostAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[CostType] [nvarchar](<span style="color:#40a070">200</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactITMachine.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactITMachine
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactITMachine;

<span style="color:#60a0b0;font-style:italic">--FactITSLA
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactITSLA (
	[ITSLAkey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[MachineKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageStartTime] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[OutageEndTime] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DownTime] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactITSLA.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactITSLA
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactITSLA;

<span style="color:#60a0b0;font-style:italic">--FactOnlineSales
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactOnlineSales (
	[OnlineSalesKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CustomerKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesOrderNumber] [nvarchar](<span style="color:#40a070">20</span>) <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesOrderLineNumber] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactOnlineSales.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactOnlineSales
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactOnlineSales;

<span style="color:#60a0b0;font-style:italic">--FactSales
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactSales (
	[SalesKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[channelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[PromotionKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[UnitPrice] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ReturnAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountQuantity] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[DiscountAmount] [money] <span style="color:#007020;font-weight:bold">NULL</span>,
	[TotalCost] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactSales.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactSales
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactSales;

<span style="color:#60a0b0;font-style:italic">--FactSalesQuota
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactSalesQuota (
	[SalesQuotaKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ChannelKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[StoreKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[DateKey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesQuantityQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[SalesAmountQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[GrossMarginQuota] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactSalesQuota.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactSalesQuota
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactSalesQuota;

<span style="color:#60a0b0;font-style:italic">--FactStrategyPlan
</span><span style="color:#60a0b0;font-style:italic"></span><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">EXTERNAL</span> <span style="color:#007020;font-weight:bold">TABLE</span> ext.FactStrategyPlan (
	[StrategyPlanKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[Datekey] [datetime] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[EntityKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ScenarioKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[AccountKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[CurrencyKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>,
	[ProductCategoryKey] [<span style="color:#007020">int</span>] <span style="color:#007020;font-weight:bold">NULL</span>,
	[Amount] [money] <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
)
<span style="color:#007020;font-weight:bold">WITH</span> (
        <span style="color:#007020;font-weight:bold">LOCATION</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">data/FactStrategyPlan.txt.gz</span><span style="color:#4070a0">&#39;</span>, 
        DATA_SOURCE<span style="color:#666">=</span>AzureStorage, 
        FILE_FORMAT<span style="color:#666">=</span>TextFileFormat
);

<span style="color:#007020;font-weight:bold">INSERT</span> <span style="color:#007020;font-weight:bold">INTO</span> dbo.FactStrategyPlan
	<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#666">*</span> <span style="color:#007020;font-weight:bold">FROM</span> ext.FactStrategyPlan;
</code></pre></div><p>To conclude we now need to update statistics on our ContosoRetailDW SQL Data Warehouse. Without proper statistics, you will not get the performance that SQL Data Warehouse is designed to provide. Tables and columns do not have statistics automatically generated by SQL Data Warehouse and so you need to create them yourself. Will be using a stored procedure named <strong>dbo.prc_sqldw_create_stats</strong> to create statistics on all columns in a database.(<!-- raw HTML omitted -->Manage statistics in SQL Data Warehouse<!-- raw HTML omitted -->)</p>
<p>To create statistics on all columns in the table with this procedure, simply call the procedure:<br>
exec prc_sqldw_create_stats;</p>
<p><strong>dbo.prc_sqldw_create_stats</strong></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">PROCEDURE</span>    [dbo].[prc_sqldw_create_stats]
(   <span style="color:#666">@</span>create_type    tinyint <span style="color:#60a0b0;font-style:italic">-- 1 default 2 Fullscan 3 Sample
</span><span style="color:#60a0b0;font-style:italic"></span>,   <span style="color:#666">@</span>sample_pct     tinyint
)
<span style="color:#007020;font-weight:bold">AS</span>

<span style="color:#007020;font-weight:bold">IF</span> <span style="color:#666">@</span>create_type <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">IN</span> (<span style="color:#40a070">1</span>,<span style="color:#40a070">2</span>,<span style="color:#40a070">3</span>)
<span style="color:#007020;font-weight:bold">BEGIN</span>
    THROW <span style="color:#40a070">151000</span>,<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">Invalid value for @stats_type parameter. Valid range 1 (default), 2 (fullscan) or 3 (sample).</span><span style="color:#4070a0">&#39;</span>,<span style="color:#40a070">1</span>;
<span style="color:#007020;font-weight:bold">END</span>;

<span style="color:#007020;font-weight:bold">IF</span> <span style="color:#666">@</span>sample_pct <span style="color:#007020;font-weight:bold">IS</span> <span style="color:#007020;font-weight:bold">NULL</span>
<span style="color:#007020;font-weight:bold">BEGIN</span>;
    <span style="color:#007020;font-weight:bold">SET</span> <span style="color:#666">@</span>sample_pct <span style="color:#666">=</span> <span style="color:#40a070">20</span>;
<span style="color:#007020;font-weight:bold">END</span>;

<span style="color:#007020;font-weight:bold">IF</span> OBJECT_ID(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">tempdb..#stats_ddl</span><span style="color:#4070a0">&#39;</span>) <span style="color:#007020;font-weight:bold">IS</span> <span style="color:#007020;font-weight:bold">NOT</span> <span style="color:#007020;font-weight:bold">NULL</span>
<span style="color:#007020;font-weight:bold">BEGIN</span>;
    <span style="color:#007020;font-weight:bold">DROP</span> <span style="color:#007020;font-weight:bold">TABLE</span> <span style="color:#666">#</span>stats_ddl;
<span style="color:#007020;font-weight:bold">END</span>;

<span style="color:#007020;font-weight:bold">CREATE</span> <span style="color:#007020;font-weight:bold">TABLE</span> <span style="color:#666">#</span>stats_ddl
<span style="color:#007020;font-weight:bold">WITH</span>    (   DISTRIBUTION    <span style="color:#666">=</span> HASH([seq_nmbr])
        ,   <span style="color:#007020;font-weight:bold">LOCATION</span>        <span style="color:#666">=</span> USER_DB
        )
<span style="color:#007020;font-weight:bold">AS</span>
<span style="color:#007020;font-weight:bold">WITH</span> T
<span style="color:#007020;font-weight:bold">AS</span>
(
<span style="color:#007020;font-weight:bold">SELECT</span>      t.[name]                        <span style="color:#007020;font-weight:bold">AS</span> [<span style="color:#007020;font-weight:bold">table_name</span>]
,           s.[name]                        <span style="color:#007020;font-weight:bold">AS</span> [table_schema_name]
,           <span style="color:#007020;font-weight:bold">c</span>.[name]                        <span style="color:#007020;font-weight:bold">AS</span> [<span style="color:#007020;font-weight:bold">column_name</span>]
,           <span style="color:#007020;font-weight:bold">c</span>.[column_id]                   <span style="color:#007020;font-weight:bold">AS</span> [column_id]
,           t.[object_id]                   <span style="color:#007020;font-weight:bold">AS</span> [object_id]
,           ROW_NUMBER()
            OVER(<span style="color:#007020;font-weight:bold">ORDER</span> <span style="color:#007020;font-weight:bold">BY</span> (<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#007020;font-weight:bold">NULL</span>))    <span style="color:#007020;font-weight:bold">AS</span> [seq_nmbr]
<span style="color:#007020;font-weight:bold">FROM</span>        sys.[tables] t
<span style="color:#007020;font-weight:bold">JOIN</span>        sys.[schemas] s         <span style="color:#007020;font-weight:bold">ON</span>  t.[schema_id]       <span style="color:#666">=</span> s.[schema_id]
<span style="color:#007020;font-weight:bold">JOIN</span>        sys.[columns] <span style="color:#007020;font-weight:bold">c</span>         <span style="color:#007020;font-weight:bold">ON</span>  t.[object_id]       <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">c</span>.[object_id]
<span style="color:#007020;font-weight:bold">LEFT</span> <span style="color:#007020;font-weight:bold">JOIN</span>   sys.[stats_columns] l   <span style="color:#007020;font-weight:bold">ON</span>  l.[object_id]       <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">c</span>.[object_id]
                                    <span style="color:#007020;font-weight:bold">AND</span> l.[column_id]       <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">c</span>.[column_id]
                                    <span style="color:#007020;font-weight:bold">AND</span> l.[stats_column_id] <span style="color:#666">=</span> <span style="color:#40a070">1</span>
<span style="color:#007020;font-weight:bold">LEFT</span> <span style="color:#007020;font-weight:bold">JOIN</span>   sys.[external_tables] e <span style="color:#007020;font-weight:bold">ON</span>  e.[object_id]       <span style="color:#666">=</span> t.[object_id]
<span style="color:#007020;font-weight:bold">WHERE</span>       l.[object_id] <span style="color:#007020;font-weight:bold">IS</span> <span style="color:#007020;font-weight:bold">NULL</span>
<span style="color:#007020;font-weight:bold">AND</span>         e.[object_id] <span style="color:#007020;font-weight:bold">IS</span> <span style="color:#007020;font-weight:bold">NULL</span> <span style="color:#60a0b0;font-style:italic">-- not an external table
</span><span style="color:#60a0b0;font-style:italic"></span>)
<span style="color:#007020;font-weight:bold">SELECT</span>  [table_schema_name]
,       [<span style="color:#007020;font-weight:bold">table_name</span>]
,       [<span style="color:#007020;font-weight:bold">column_name</span>]
,       [column_id]
,       [object_id]
,       [seq_nmbr]
,       <span style="color:#007020;font-weight:bold">CASE</span> <span style="color:#666">@</span>create_type
        <span style="color:#007020;font-weight:bold">WHEN</span> <span style="color:#40a070">1</span>
        <span style="color:#007020;font-weight:bold">THEN</span>    <span style="color:#007020;font-weight:bold">CAST</span>(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">CREATE STATISTICS </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">stat_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>table_schema_name<span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span> <span style="color:#666">+</span> <span style="color:#007020;font-weight:bold">table_name</span> <span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span><span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0"> ON </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(table_schema_name)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">.</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">table_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">(</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">)</span><span style="color:#4070a0">&#39;</span> <span style="color:#007020;font-weight:bold">AS</span> <span style="color:#007020">VARCHAR</span>(<span style="color:#40a070">8000</span>))
        <span style="color:#007020;font-weight:bold">WHEN</span> <span style="color:#40a070">2</span>
        <span style="color:#007020;font-weight:bold">THEN</span>    <span style="color:#007020;font-weight:bold">CAST</span>(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">CREATE STATISTICS </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">stat_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>table_schema_name<span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span> <span style="color:#666">+</span> <span style="color:#007020;font-weight:bold">table_name</span> <span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span><span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0"> ON </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(table_schema_name)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">.</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">table_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">(</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">) WITH FULLSCAN</span><span style="color:#4070a0">&#39;</span> <span style="color:#007020;font-weight:bold">AS</span> <span style="color:#007020">VARCHAR</span>(<span style="color:#40a070">8000</span>))
        <span style="color:#007020;font-weight:bold">WHEN</span> <span style="color:#40a070">3</span>
        <span style="color:#007020;font-weight:bold">THEN</span>    <span style="color:#007020;font-weight:bold">CAST</span>(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">CREATE STATISTICS </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">stat_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>table_schema_name<span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span> <span style="color:#666">+</span> <span style="color:#007020;font-weight:bold">table_name</span> <span style="color:#666">+</span> <span style="color:#4070a0">&#39;</span><span style="color:#4070a0">_</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span><span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0"> ON </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(table_schema_name)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">.</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">table_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">(</span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span>QUOTENAME(<span style="color:#007020;font-weight:bold">column_name</span>)<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">) WITH SAMPLE </span><span style="color:#4070a0">&#39;</span><span style="color:#666">+</span><span style="color:#666">@</span>sample_pct<span style="color:#666">+</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">PERCENT</span><span style="color:#4070a0">&#39;</span> <span style="color:#007020;font-weight:bold">AS</span> <span style="color:#007020">VARCHAR</span>(<span style="color:#40a070">8000</span>))
        <span style="color:#007020;font-weight:bold">END</span> <span style="color:#007020;font-weight:bold">AS</span> create_stat_ddl
<span style="color:#007020;font-weight:bold">FROM</span> T
;

<span style="color:#007020;font-weight:bold">DECLARE</span> <span style="color:#666">@</span>i <span style="color:#007020">INT</span>              <span style="color:#666">=</span> <span style="color:#40a070">1</span>
,       <span style="color:#666">@</span>t <span style="color:#007020">INT</span>              <span style="color:#666">=</span> (<span style="color:#007020;font-weight:bold">SELECT</span> <span style="color:#007020;font-weight:bold">COUNT</span>(<span style="color:#666">*</span>) <span style="color:#007020;font-weight:bold">FROM</span> <span style="color:#666">#</span>stats_ddl)
,       <span style="color:#666">@</span>s NVARCHAR(<span style="color:#40a070">4000</span>)   <span style="color:#666">=</span> N<span style="color:#4070a0">&#39;</span><span style="color:#4070a0">&#39;</span>
;

WHILE <span style="color:#666">@</span>i <span style="color:#666">&amp;</span>lt; <span style="color:#666">=</span> <span style="color:#666">@</span>t
<span style="color:#007020;font-weight:bold">BEGIN</span>
    <span style="color:#007020;font-weight:bold">SET</span> <span style="color:#666">@</span>s<span style="color:#666">=</span>(<span style="color:#007020;font-weight:bold">SELECT</span> create_stat_ddl <span style="color:#007020;font-weight:bold">FROM</span> <span style="color:#666">#</span>stats_ddl <span style="color:#007020;font-weight:bold">WHERE</span> seq_nmbr <span style="color:#666">=</span> <span style="color:#666">@</span>i);

    PRINT <span style="color:#666">@</span>s
    <span style="color:#007020;font-weight:bold">EXEC</span> sp_executesql <span style="color:#666">@</span>s
    <span style="color:#007020;font-weight:bold">SET</span> <span style="color:#666">@</span>i<span style="color:#666">+</span><span style="color:#666">=</span><span style="color:#40a070">1</span>;
<span style="color:#007020;font-weight:bold">END</span>

<span style="color:#007020;font-weight:bold">DROP</span> <span style="color:#007020;font-weight:bold">TABLE</span> <span style="color:#666">#</span>stats_ddl;
</code></pre></div><p>We are done! Explore, write some queries, scale compute resources up and down, connect with PowerBI and create awesome data visualizations. Just remember to <strong>pause</strong> your SQL Data Warehouse when not using it.<br>
Enjoy!</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

      </div>

      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "stephanefrechettedev" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
     Â© 2019 StÃ©phane FrÃ©chette | <a href="https://stephanefrechette.dev/index.xml">Subscribe RSS</a> 
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-137528572-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  </body>

</html>
